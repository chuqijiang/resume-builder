{"version":3,"sources":["../../../../../libs/parser/src/linkedin/index.ts"],"sourcesContent":["import { createId } from \"@paralleldrive/cuid2\";\nimport {\n  defaultCertification,\n  defaultEducation,\n  defaultExperience,\n  defaultLanguage,\n  defaultProfile,\n  defaultProject,\n  defaultResumeData,\n  defaultSkill,\n  resumeDataSchema,\n} from \"@reactive-resume/schema\";\nimport { extractUrl, Json, parseArrayLikeCSVEntry, parseCSV } from \"@reactive-resume/utils\";\nimport * as JSZip from \"jszip\";\nimport { Schema } from \"zod\";\n\nimport { Parser } from \"../interfaces/parser\";\nimport { LinkedIn, linkedInSchema } from \"./schema\";\n\nexport * from \"./schema\";\n\nconst avoidTooShort = (name: string, len: number) => {\n  if (!name || name.length < len) return \"Unknown\";\n  return name;\n};\n\nexport class LinkedInParser implements Parser<JSZip, LinkedIn> {\n  schema: Schema;\n\n  constructor() {\n    this.schema = linkedInSchema;\n  }\n\n  async readFile(file: File): Promise<JSZip> {\n    const data = await JSZip.loadAsync(file);\n\n    if (Object.keys(data.files).length === 0) {\n      throw new Error(\"ParserError: There were no files found inside the zip archive.\");\n    }\n\n    return data;\n  }\n\n  async validate(data: JSZip) {\n    const result: Json = {};\n\n    for (const [name, file] of Object.entries(data.files)) {\n      for (const key of Object.keys(linkedInSchema.shape)) {\n        if (name.includes(key)) {\n          const content = await file.async(\"text\");\n          result[key] = await parseCSV(content);\n        }\n      }\n    }\n\n    return linkedInSchema.parse(result);\n  }\n\n  convert(data: LinkedIn) {\n    const result = JSON.parse(JSON.stringify(defaultResumeData));\n\n    // Profile\n    if (data.Profile && data.Profile.length > 0) {\n      const profile = data.Profile[0];\n      const twitterHandle = profile[\"Twitter Handles\"];\n\n      result.basics.name = `${profile[\"First Name\"]} ${profile[\"Last Name\"]}`;\n      result.basics.location = profile[\"Geo Location\"];\n      result.basics.headline = profile.Headline;\n      // profile.Websites is represented as an array-like structure f.e. [COMPANY:https://some.link,PORTFOLIO:...]\n      const extractFirstWebsiteLink = (entry: string) =>\n        (parseArrayLikeCSVEntry(entry)[0] ?? \"\").replace(/.*?:/, \"\");\n      result.basics.url.href = extractUrl(extractFirstWebsiteLink(profile.Websites)) ?? \"\";\n      result.sections.summary.content = profile.Summary;\n      if (twitterHandle) {\n        result.sections.profiles.items.push({\n          ...defaultProfile,\n          id: createId(),\n          icon: \"twitter\",\n          network: \"Twitter\",\n          username: twitterHandle,\n          url: { ...defaultProfile.url, href: `https://twitter.com/${twitterHandle}` },\n        });\n      }\n    }\n\n    // Email Addresses\n    if (data[\"Email Addresses\"] && data[\"Email Addresses\"].length > 0) {\n      const email = data[\"Email Addresses\"][0];\n\n      result.basics.email = email[\"Email Address\"];\n    }\n\n    // Positions\n    if (data.Positions && data.Positions.length > 0) {\n      for (const position of data.Positions) {\n        result.sections.experience.items.push({\n          ...defaultExperience,\n          id: createId(),\n          company: position[\"Company Name\"],\n          position: position.Title,\n          location: position.Location,\n          summary: position.Description ?? \"\",\n          date: `${position[\"Started On\"]} - ${position[\"Finished On\"] ?? \"Present\"}`,\n        });\n      }\n    }\n\n    // Education\n    if (data.Education && data.Education.length > 0) {\n      for (const education of data.Education) {\n        result.sections.education.items.push({\n          ...defaultEducation,\n          id: createId(),\n          institution: avoidTooShort(education[\"School Name\"], 2),\n          studyType: avoidTooShort(education[\"Degree Name\"], 2),\n          summary: avoidTooShort(education.Notes ?? \"\", 2),\n          date: `${education[\"Start Date\"]} - ${education[\"End Date\"] ?? \"Present\"}`,\n        });\n      }\n    }\n\n    // Skills\n    if (data.Skills && data.Skills.length > 0) {\n      for (const skill of data.Skills) {\n        result.sections.skills.items.push({\n          ...defaultSkill,\n          id: createId(),\n          name: skill.Name,\n        });\n      }\n    }\n\n    // Languages\n    if (data.Languages && data.Languages.length > 0) {\n      for (const language of data.Languages) {\n        result.sections.languages.items.push({\n          ...defaultLanguage,\n          id: createId(),\n          name: language.Name,\n          description: language.Proficiency ?? \"\",\n        });\n      }\n    }\n\n    // Certifications\n    if (data.Certifications && data.Certifications.length > 0) {\n      for (const certification of data.Certifications) {\n        result.sections.certifications.items.push({\n          ...defaultCertification,\n          id: createId(),\n          name: certification.Name,\n          issuer: certification.Authority,\n          url: { ...defaultCertification.url, href: certification.Url },\n          date: `${certification[\"Started On\"]} - ${certification[\"Finished On\"] ?? \"Present\"}`,\n        });\n      }\n    }\n\n    // Projects\n    if (data.Projects && data.Projects.length > 0) {\n      for (const project of data.Projects) {\n        result.sections.projects.items.push({\n          ...defaultProject,\n          id: createId(),\n          name: project.Title,\n          description: project.Description,\n          url: { ...defaultProject.url, href: project.Url ?? \"\" },\n          date: `${project[\"Started On\"]} - ${project[\"Finished On\"] ?? \"Present\"}`,\n        });\n      }\n    }\n\n    return resumeDataSchema.parse(result);\n  }\n}\n"],"names":["LinkedInParser","avoidTooShort","name","len","length","readFile","file","data","JSZip","loadAsync","Object","keys","files","Error","validate","result","entries","key","linkedInSchema","shape","includes","content","async","parseCSV","parse","convert","JSON","stringify","defaultResumeData","Profile","profile","twitterHandle","basics","location","headline","Headline","extractFirstWebsiteLink","entry","parseArrayLikeCSVEntry","replace","extractUrl","url","href","Websites","sections","summary","Summary","profiles","items","push","defaultProfile","id","createId","icon","network","username","email","Positions","position","experience","defaultExperience","company","Title","Location","Description","date","Education","education","defaultEducation","institution","studyType","Notes","Skills","skill","skills","defaultSkill","Name","Languages","language","languages","defaultLanguage","description","Proficiency","Certifications","certification","certifications","defaultCertification","issuer","Authority","Url","Projects","project","projects","defaultProject","resumeDataSchema","constructor","schema"],"mappings":"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"}