{"version":3,"file":"connect.js","sources":["../../../../src/integrations/tracing/connect.ts"],"sourcesContent":["import { isWrapped } from '@opentelemetry/core';\nimport { ConnectInstrumentation } from '@opentelemetry/instrumentation-connect';\nimport { captureException, defineIntegration, isEnabled } from '@sentry/core';\nimport { addOpenTelemetryInstrumentation } from '@sentry/opentelemetry';\nimport type { IntegrationFn } from '@sentry/types';\nimport { consoleSandbox } from '@sentry/utils';\n\ntype ConnectApp = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  use: (middleware: any) => void;\n};\n\nconst _connectIntegration = (() => {\n  return {\n    name: 'Connect',\n    setupOnce() {\n      addOpenTelemetryInstrumentation(new ConnectInstrumentation({}));\n    },\n  };\n}) satisfies IntegrationFn;\n\nexport const connectIntegration = defineIntegration(_connectIntegration);\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction connectErrorMiddleware(err: any, req: any, res: any, next: any): void {\n  captureException(err);\n  next(err);\n}\n\nexport const setupConnectErrorHandler = (app: ConnectApp): void => {\n  app.use(connectErrorMiddleware);\n\n  if (!isWrapped(app.use) && isEnabled()) {\n    consoleSandbox(() => {\n      // eslint-disable-next-line no-console\n      console.warn(\n        '[Sentry] Connect is not instrumented. This is likely because you required/imported connect before calling `Sentry.init()`.',\n      );\n    });\n  }\n};\n"],"names":["addOpenTelemetryInstrumentation","ConnectInstrumentation","defineIntegration","captureException","isWrapped","isEnabled","consoleSandbox"],"mappings":";;;;;;;;AAYA,MAAM,mBAAoB,IAAG,MAAM;AACnC,EAAE,OAAO;AACT,IAAI,IAAI,EAAE,SAAS;AACnB,IAAI,SAAS,GAAG;AAChB,MAAMA,6CAA+B,CAAC,IAAIC,6CAAsB,CAAC,EAAE,CAAC,CAAC,CAAA;AACrE,KAAK;AACL,GAAG,CAAA;AACH,CAAC,CAAE,EAAA;AACH;MACa,kBAAmB,GAAEC,sBAAiB,CAAC,mBAAmB,EAAC;AACxE;AACA;AACA,SAAS,sBAAsB,CAAC,GAAG,EAAO,GAAG,EAAO,GAAG,EAAO,IAAI,EAAa;AAC/E,EAAEC,qBAAgB,CAAC,GAAG,CAAC,CAAA;AACvB,EAAE,IAAI,CAAC,GAAG,CAAC,CAAA;AACX,CAAA;AACA;AACa,MAAA,wBAAA,GAA2B,CAAC,GAAG,KAAuB;AACnE,EAAE,GAAG,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAA;AACjC;AACA,EAAE,IAAI,CAACC,gBAAS,CAAC,GAAG,CAAC,GAAG,CAAE,IAAGC,cAAS,EAAE,EAAE;AAC1C,IAAIC,oBAAc,CAAC,MAAM;AACzB;AACA,MAAM,OAAO,CAAC,IAAI;AAClB,QAAQ,4HAA4H;AACpI,OAAO,CAAA;AACP,KAAK,CAAC,CAAA;AACN,GAAE;AACF;;;;;"}